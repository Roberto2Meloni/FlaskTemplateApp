{% extends "layouts/web_app_layouts/Einkaufsliste_web_app_base.html" %} {% block
content %}
<div class="einkaufsliste-container">
  <div class="page-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="page-title">
          <i class="bi bi-people-fill"></i>
          Gruppe Erstellen
        </h1>
        <div class="header-info">
          <i class="bi bi-info-circle"></i>
          Erstellen Sie eine neue Einkaufsgruppe
        </div>
      </div>
      <div class="header-right">
        <div class="date-display">
          <i class="bi bi-calendar3"></i>
          <span class="current-date" id="current-date"></span>
        </div>
      </div>
    </div>
  </div>

  {% include "layouts/websites/flash_message.html" %}

  <!-- Form Tips -->
  <div class="form-tips">
    <div class="tips-header">
      <i class="bi bi-lightbulb"></i>
      Tipps zum Erstellen einer Gruppe
    </div>
    <div class="tips-content">
      <div class="tip-item">
        <i class="bi bi-check-circle"></i>
        Wählen Sie einen aussagekräftigen Gruppennamen
      </div>
      <div class="tip-item">
        <i class="bi bi-people"></i>
        Fügen Sie Mitglieder hinzu, die gemeinsam einkaufen
      </div>
      <div class="tip-item">
        <i class="bi bi-eye"></i>
        Entscheiden Sie über Sichtbarkeit und Zugriffsrechte
      </div>
    </div>
  </div>

  <!-- Form Container -->
  <div class="form-container">
    <div class="form-card">
      <!-- Form Header -->
      <div class="form-header">
        <div class="form-icon-container">
          <i class="form-icon bi bi-people-fill"></i>
        </div>
        <h2 class="form-title">Neue Gruppe erstellen</h2>
        <p class="form-subtitle">
          Geben Sie die Details für Ihre neue Einkaufsgruppe ein
        </p>
      </div>

      <!-- Form Body -->
      <form action="" method="post">
        {{ form.hidden_tag() }}

        <div class="form-body">
          <!-- Gruppenname -->
          <div class="form-group">
            <div class="form-label-container">
              <i class="bi bi-tag-fill"></i>
              {{ form.group_name.label(class_='form-label-modern') }}
            </div>
            <div class="form-input-container">
              {{ form.group_name(class_='form-control-modern', placeholder='z.B.
              Familie Schmidt, WG Musterstraße...') }}
              <i class="form-input-icon bi bi-tag"></i>
            </div>
            <small class="form-help-text"
              >Wählen Sie einen eindeutigen und erkennbaren Namen für Ihre
              Gruppe</small
            >
          </div>

          <!-- Gruppenmitglieder -->
          <div class="form-group">
            <div class="form-label-container">
              <i class="bi bi-people"></i>
              {{ form.group_members.label(class='form-label-modern') }}
            </div>
            <div class="form-select-container">
              {{ form.group_members(class='form-select-modern select2',
              multiple=True) }}
              <i class="form-select-icon bi bi-chevron-down"></i>
            </div>
            <small class="form-help-text"
              >Wählen Sie die Benutzer aus, die Mitglieder dieser Gruppe werden
              sollen</small
            >
          </div>

          <!-- Gruppe öffentlich -->
          <div class="form-group">
            <div class="form-checkbox-container">
              <div class="checkbox-wrapper">
                {{ form.group_public(class="form-checkbox-modern") }}
                <label
                  for="{{ form.group_public.id }}"
                  class="checkbox-label-modern"
                >
                  <div class="checkbox-icon">
                    <i class="bi bi-unlock-fill"></i>
                  </div>
                  <div class="checkbox-content">
                    <span class="checkbox-title"
                      >{{ form.group_public.label.text }}</span
                    >
                    <span class="checkbox-description"
                      >Jeder Benutzer kann dieser Gruppe beitreten und auf
                      Einkaufslisten zugreifen</span
                    >
                  </div>
                </label>
              </div>
            </div>
          </div>

          <!-- Gruppe sichtbar -->
          <div class="form-group">
            <div class="form-checkbox-container">
              <div class="checkbox-wrapper">
                {{ form.group_visible(class="form-checkbox-modern") }}
                <label
                  for="{{ form.group_visible.id }}"
                  class="checkbox-label-modern"
                >
                  <div class="checkbox-icon">
                    <i class="bi bi-eye-fill"></i>
                  </div>
                  <div class="checkbox-content">
                    <span class="checkbox-title"
                      >{{ form.group_visible.label.text }}</span
                    >
                    <span class="checkbox-description"
                      >Die Gruppe erscheint in Suchergebnissen und öffentlichen
                      Listen</span
                    >
                  </div>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <div class="action-buttons-container">
            <a
              href="{{ url_for('Einkaufsliste.Einkaufsliste_index') }}"
              class="btn-custom btn-cancel"
            >
              <i class="bi bi-x-circle"></i>
              <span class="btn-text">Abbrechen</span>
            </a>
            {{ form.submit(class_='btn-custom btn-success-custom btn-submit') }}
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Aktuelles Datum anzeigen
  document.addEventListener("DOMContentLoaded", function () {
    const currentDateElement = document.getElementById("current-date");
    const now = new Date();
    const options = {
      weekday: "long",
      year: "numeric",
      month: "long",
      day: "numeric",
    };
    currentDateElement.textContent = now.toLocaleDateString("de-DE", options);

    // Form Groups Animation
    const formGroups = document.querySelectorAll(".form-group");
    formGroups.forEach((group, index) => {
      setTimeout(() => {
        group.style.opacity = "1";
        group.style.transform = "translateY(0)";
      }, index * 150);
    });

    // Input Focus Effects
    const inputs = document.querySelectorAll(
      ".form-control-modern, .form-select-modern"
    );
    inputs.forEach((input) => {
      const container = input.closest(
        ".form-input-container, .form-select-container"
      );

      input.addEventListener("focus", function () {
        container.classList.add("focused");
      });

      input.addEventListener("blur", function () {
        container.classList.remove("focused");
      });
    });

    // Form Submission Loading State
    const form = document.querySelector("form");
    const submitBtn = document.querySelector(".btn-submit");

    if (form && submitBtn) {
      form.addEventListener("submit", function () {
        submitBtn.classList.add("loading");
        submitBtn.disabled = true;
      });
    }
  });
</script>
{% endblock %} {% block scripts %} {{ super() }}
<script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
<script>
  $(document).ready(function () {
    // Select2 Initialization mit modernem Styling
    $(".select2").select2({
      placeholder: "Mitglieder auswählen...",
      allowClear: true,
      width: "100%",
      theme: "default",
      language: {
        noResults: function () {
          return "Keine Ergebnisse gefunden";
        },
        searching: function () {
          return "Suche...";
        },
        loadingMore: function () {
          return "Lade weitere Ergebnisse...";
        },
      },
    });

    // Select2 Focus Effects
    $(".select2").on("select2:open", function () {
      $(this).closest(".form-select-container").addClass("focused");
    });

    $(".select2").on("select2:close", function () {
      $(this).closest(".form-select-container").removeClass("focused");
    });

    // Tooltip Initialization (falls Bootstrap Tooltips verwendet werden)
    if (typeof bootstrap !== "undefined") {
      var tooltipTriggerList = [].slice.call(
        document.querySelectorAll('[data-bs-toggle="tooltip"]')
      );
      var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
      });
    }
  });
</script>

<style>
  /* Zusätzliche Styling für Select2 Integration */
  .select2-container {
    width: 100% !important;
  }

  .select2-container .select2-selection--multiple {
    border: 2px solid rgba(0, 0, 0, 0.1) !important;
    border-radius: 12px !important;
    background: rgba(255, 255, 255, 0.9) !important;
    min-height: 50px !important;
    padding: 0.5rem !important;
  }

  .select2-container--default .select2-selection--multiple:focus-within {
    border-color: #198754 !important;
    box-shadow: 0 0 0 4px rgba(25, 135, 84, 0.15) !important;
  }

  .select2-container--default
    .select2-selection--multiple
    .select2-selection__choice {
    background-color: #198754 !important;
    border: none !important;
    color: white !important;
    border-radius: 20px !important;
    padding: 0.25rem 0.75rem !important;
    font-size: 0.85rem !important;
    font-weight: 500 !important;
  }

  .select2-container--default
    .select2-selection--multiple
    .select2-selection__choice__remove {
    color: rgba(255, 255, 255, 0.8) !important;
    margin-right: 0.5rem !important;
  }

  .select2-container--default
    .select2-selection--multiple
    .select2-selection__choice__remove:hover {
    color: white !important;
  }

  .select2-dropdown {
    border: 2px solid rgba(25, 135, 84, 0.2) !important;
    border-radius: 12px !important;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15) !important;
  }

  .select2-container--default
    .select2-results__option--highlighted[aria-selected] {
    background-color: #198754 !important;
  }

  /* Dark Mode Support für Select2 */
  @media (prefers-color-scheme: dark) {
    .select2-container .select2-selection--multiple {
      background: rgba(52, 58, 64, 0.9) !important;
      color: #f8f9fa !important;
      border-color: rgba(255, 255, 255, 0.15) !important;
    }

    .select2-dropdown {
      background: rgba(52, 58, 64, 0.95) !important;
      color: #f8f9fa !important;
    }

    .select2-container--default .select2-results__option {
      color: #f8f9fa !important;
    }
  }

  /* Submit Button Icon */
  .btn-submit::before {
    content: "\F26B"; /* Bootstrap Icons: check-circle */
    font-family: "bootstrap-icons";
    margin-right: 0.5rem;
  }

  /* Loading State */
  .btn-submit.loading::before {
    display: none;
  }
</style>
{% endblock %}
